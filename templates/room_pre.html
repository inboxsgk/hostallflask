<!DOCTYPE html>
<html lang="en">

<head>
    <!-- ... other head elements ... -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <title>Hostall - Potential Roommates</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='styles.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.4/dist/jquery.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
  </head>

<body>
  <header>
    <h1>Hostall</h1>
    <!--         <nav>
            <a href="#">Dashboard</a>
            <a href="#">Mess menu</a>
            <a href="#">Find Roommates</a>
            <a href="#">Lost & Found</a>
        </nav> -->
    <nav id="navbar">
      <button id="mobileMenuToggle" aria-label="Toggle menu">
        <i class="fas fa-bars"></i>
      </button>
      <div id="navLinks">
        <a href="/dashboard">Dashboard</a>
        <a href="/menu">Mess menu</a>
        <a href="/room">Find Roommates</a>
        <a href="/room1">+</a>
        <a href="#">Lost & Found</a>
      </div>
    </nav>
    <div class="user-icon">
      <i class="fas fa-user"></i> <!-- This is the Font Awesome User Icon -->
    </div>
  </header>
  <!-- ... existing HTML ... -->
  <main>
    <h2>LIST OF POTENTIAL ROOMMATES</h2>
    <!-- ... existing HTML ... -->
    <div id="searchArea" class="search-area">
      <input type="text" id="searchBar" placeholder="Search by name or branch..." onkeyup="filterRoommates()" />
      <div>
        <input type="checkbox" id="veg" name="veg" value="veg">
        <label for="veg">Vegetarian</label>
      </div>
      <div>
        <input type="checkbox" id="9ptr" name="9ptr" value="9ptr">
        <label for="9ptr">9 pointer</label>
      </div>
      <div>
        <input type="checkbox" id="morning" name="morning" value="morning">
        <label for="morning">morning batch</label>
      </div>
      <!-- Add more checkboxes as needed -->
      <button onclick="filterRoommates()" id="searchButton">Search</button>
    </div>
    <!-- ... rest of your HTML ... -->

    <section class="cards" id="cardsContainer">
      <!-- Cards will be generated by JavaScript -->
    </section>
  </main>
  <!-- ... rest of your HTML ... -->
  <div id="contactModal" class="modal">
    <!-- Modal content -->
    <div class="modal-content">
      <span class="close">&times;</span>
      <h3>Contact Details</h3>
      <div class="profile-pic-modal"></div>
      <p id="modalName"><strong>Name:</strong> Gowtham</p>
      <p id="modalPhone"><strong>Phone:</strong> +91 1234567890</p>
      <p id="modalEmail"><strong>Email:</strong> gowtham...@ent.ac.in</p>

      <p id="modalNote"><strong>Special Note:</strong> Please be adjusting</p>

    </div>
    
<!-- At the bottom of your body tag in pref.html -->
<!-- <script src="{{ url_for('static', filename='script.js') }}"></script> -->
<script>

// Example usage:
function removeLeadingTrailingQuotes(jsonString) {
  // Check if the string starts and ends with a double quote
  if (jsonString.startsWith('"') && jsonString.endsWith('"')) {
    // Remove the leading and trailing double quote
    return jsonString.slice(1, -1);
  }
  // If no leading and trailing double quote, return the string as is
  return jsonString;
}

// Example usage

var actualArray = `{{ preferences | tojson | safe }}`;

var outputJsonString = removeLeadingTrailingQuotes(actualArray);

console.log(outputJsonString); 
// var actualArray = `{{ preferences | tojson | safe }}`;
// var updatedString = replaceQuotesWithBackticks(actualArray);
//    // Parse the JSON data passed from Flask
//    var actualArray = `{{ preferences | tojson | safe }}`;
//    console.log(updatedString);
// //    var roommates = {{ preferences | tojson | safe }};
//     // Call the display function to show the roommates on load
    var roommates = JSON.parse(outputJsonString);
    document.addEventListener('DOMContentLoaded', function () {
        displayRoommates(roommates);
    });
console.log("hi");
console.log(roommates);
function createCard(roommate) {
    return `<article class="card" onclick="openModal(${JSON.stringify(roommate).replace(/"/g, '&quot;')})">
        <div class="profile-pic"></div>
        <div class="info">
            <p><strong>Name:</strong> ${roommate.name}</p>
            <p><strong>No.of Roomies I prefer:</strong> ${roommate.room_type}</p>
            <p><strong>Branch:</strong> ${roommate.branch}</p>
            <p><strong>Special Preferences:</strong> ${roommate.note}</p>
        </div>
    </article>`;
}

// Function to display roommates on the page
function displayRoommates(roommatesList) {
    const cardsContainer = document.getElementById('cardsContainer');
    cardsContainer.innerHTML = ''; // Clear the container
    roommatesList.forEach(roommate => {
        cardsContainer.innerHTML += createCard(roommate); // Add filtered roommates
    });
}

// Function to open the modal with detailed information
function openModal(roommate) {
    document.getElementById('modalName').textContent = `Name: ${roommate.name}`;
    document.getElementById('modalPhone').textContent = `Phone: ${roommate.contactDetails}`;
    document.getElementById('modalEmail').textContent = `Email: ${roommate.email}`;
    document.getElementById('modalNote').textContent = `Morning/Evening class: ${roommate.special}`;
    document.getElementById('contactModal').style.display = 'block';
}

// Function to close the modal
function closeModal() {
    document.getElementById('contactModal').style.display = 'none';
}

// Close the modal when the user clicks outside of it
window.onclick = function(event) {
    const modal = document.getElementById('contactModal');
    if (event.target === modal) {
        closeModal();
    }
}

// Function to filter roommates based on the search query and checkboxes
function filterRoommates() {
    const searchQuery = document.getElementById('searchBar').value.toLowerCase();
    const isVeg = document.getElementById('veg').checked;
    const is9ptr = document.getElementById('9ptr').checked;
    const isMorning = document.getElementById('morning').checked;

    // Apply filter conditions
    const filteredRoommates = roommates.filter(roommate => {
        const matchesSearchQuery = roommate.name.toLowerCase().includes(searchQuery) ||
                                   roommate.branch.toLowerCase().includes(searchQuery) ||
                                   roommate.special.toLowerCase().includes(searchQuery);
        const matchesVeg = !isVeg || roommate.special.toLowerCase().includes('veg');
        const matches9ptr = !is9ptr || roommate.special.toLowerCase().includes('9');
        const matchesMorning = !isMorning || roommate.special.toLowerCase().includes('morning');

        return matchesSearchQuery && matchesVeg && matches9ptr && matchesMorning;
    });

    displayRoommates(filteredRoommates);
}

// Setup event listeners and initial display
document.addEventListener('DOMContentLoaded', function () {
    // Toggle mobile menu
    document.getElementById('mobileMenuToggle').addEventListener('click', function() {
        var navLinks = document.getElementById('navLinks');
        navLinks.style.display = navLinks.style.display === 'block' ? 'none' : 'block';
    });

    // Initialize the display with all roommates
    displayRoommates(roommates);

    // Setup the close button for the modal
    var closeBtn = document.getElementsByClassName("close")[0];
    closeBtn.onclick = function() {
        closeModal();
    };
});

</script>

</body>

</html>